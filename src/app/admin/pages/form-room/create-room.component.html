<div class="max-w-5xl mx-auto space-y-6">
  
  <!-- Header -->
  <div class="bg-white rounded-xl shadow-sm p-6">
    <div class="flex justify-between items-center">
      <div>
        <h1 class="text-3xl font-bold text-gray-800">
          {{ isEditMode() ? 'Editar Habitación' : 'Nueva Habitación' }}
        </h1>
        <p class="text-gray-500 mt-1">
          {{ isEditMode() ? 'Actualiza los detalles de la habitación' : 'Ingresa los detalles para registrar una habitación' }}
        </p>
      </div>
      <button 
        (click)="cancel()"
        class="text-gray-500 hover:text-gray-700 transition-colors">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
          <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
        </svg>
      </button>
    </div>
  </div>

  <!-- Formulario -->
  <form [formGroup]="roomForm" (ngSubmit)="onSubmit()" class="bg-white rounded-xl shadow-sm p-6 space-y-8">
    
    <!-- Información General -->
    <div>
      <h3 class="text-xl font-semibold mb-6 text-gray-800 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-indigo-600">
          <path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z" />
        </svg>
        Información General
      </h3>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        
        <!-- Número Habitación -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Número Habitación <span class="text-red-500">*</span>
          </label>
          <input 
            type="text" 
            formControlName="NumeroHabitacion" 
            placeholder="Ej: 101" 
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400 bg-white"
            [class.border-red-500]="roomForm.get('NumeroHabitacion')?.invalid && roomForm.get('NumeroHabitacion')?.touched"/>
          @if (roomForm.get('NumeroHabitacion')?.invalid && roomForm.get('NumeroHabitacion')?.touched) {
            <p class="mt-1 text-sm text-red-500">Este campo es requerido</p>
          }
        </div>

        <!-- Tipo de Habitación -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Tipo de Habitación <span class="text-red-500">*</span>
          </label>
          <select 
            formControlName="TipoHabitacionId" 
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all text-gray-900 bg-white"
            [class.border-red-500]="roomForm.get('TipoHabitacionId')?.invalid && roomForm.get('TipoHabitacionId')?.touched">
            <option value="">Selecciona un tipo de habitación</option>
            @for (tipo of tiposHabitacion; track tipo.id) {
              <option [value]="tipo.id">{{ tipo.nombre }}</option>
            }
          </select>
          @if (roomForm.get('TipoHabitacionId')?.invalid && roomForm.get('TipoHabitacionId')?.touched) {
            <p class="mt-1 text-sm text-red-500">Selecciona un tipo de habitación</p>
          }
          
          <!-- Debug: Mostrar cuántos tipos hay -->
          @if (tiposHabitacion.length === 0) {
            <p class="mt-1 text-xs text-gray-400">Cargando tipos de habitación...</p>
          }
        </div>

        <!-- Piso -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Piso <span class="text-red-500">*</span>
          </label>
          <input 
            type="number" 
            formControlName="Piso" 
            placeholder="Ej: 1" 
            min="1"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400 bg-white" />
        </div>

        <!-- Precio Base -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Precio Base ($) <span class="text-red-500">*</span>
          </label>
          <div class="relative">
            <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500">$</span>
            <input 
              type="number" 
              formControlName="PrecioBase" 
              placeholder="0.00" 
              min="0"
              step="0.01"
              class="w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400 bg-white" />
          </div>
        </div>

        <!-- Capacidad -->
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2">
            Capacidad (Personas) <span class="text-red-500">*</span>
          </label>
          <input 
            type="number" 
            formControlName="Capacidad" 
            placeholder="Ej: 2" 
            min="1"
            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all text-gray-900 placeholder-gray-400 bg-white" />
        </div>

      </div>

      <!-- Descripción -->
      <div class="mt-6">
        <label class="block text-sm font-medium text-gray-700 mb-2">
          Descripción <span class="text-red-500">*</span>
        </label>
        <textarea 
          formControlName="Descripcion" 
          rows="4"
          placeholder="Detalles de la habitación..."
          class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all resize-none text-gray-900 placeholder-gray-400 bg-white"></textarea>
      </div>
    </div>

    <!-- Divisor -->
    <div class="border-t border-gray-200"></div>

    <!-- Servicios Incluidos -->
    <div>
      <h3 class="text-xl font-semibold mb-6 text-gray-800 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-indigo-600">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
        </svg>
        Servicios Incluidos
      </h3>
      
      <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        @for (servicio of serviciosDisponibles; track servicio.id) {
          <label class="cursor-pointer flex items-center gap-3 border border-gray-200 rounded-lg p-4 hover:bg-gray-50 hover:border-indigo-300 transition-all group">
            <input 
              type="checkbox" 
              class="w-5 h-5 text-indigo-600 border-gray-300 rounded focus:ring-2 focus:ring-indigo-500 cursor-pointer" 
              [value]="servicio.id"
              [checked]="isServiceSelected(servicio.id)"
              (change)="onServiceChange($event, servicio.id)" />
            <span class="text-sm font-medium text-gray-700 group-hover:text-indigo-600">{{ servicio.nombre }}</span>
          </label>
        }
      </div>
    </div>

    <!-- Divisor -->
    <div class="border-t border-gray-200"></div>

    <!-- Galería de Fotos -->
    <div>
      <h3 class="text-xl font-semibold mb-6 text-gray-800 flex items-center gap-2">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 text-indigo-600">
          <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
        </svg>
        Galería de Fotos
      </h3>
      
      <div class="border-2 border-dashed border-gray-300 rounded-lg p-12 text-center hover:bg-gray-50 hover:border-indigo-400 transition-all relative group">
        <input 
          type="file" 
          multiple 
          accept="image/*"
          (change)="onFileSelect($event)" 
          class="absolute inset-0 w-full h-full opacity-0 cursor-pointer" />
        
        <div class="flex flex-col items-center">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-16 h-16 text-gray-400 mb-4 group-hover:text-indigo-500 transition-colors">
            <path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5m-13.5-9L12 3m0 0 4.5 4.5M12 3v13.5" />
          </svg>
          <span class="text-base font-medium text-gray-700 mb-1">
            {{ selectedFiles.length > 0 ? selectedFiles.length + ' archivos seleccionados' : 'Haz clic o arrastra imágenes aquí' }}
          </span>
          <span class="text-sm text-gray-500">PNG, JPG hasta 5MB cada una</span>
        </div>
      </div>
      
      @if (selectedFiles.length > 0) {
        <div class="mt-4 flex flex-wrap gap-2">
          @for (file of selectedFiles; track file.name) {
            <span class="inline-flex items-center gap-2 px-3 py-1 bg-indigo-100 text-indigo-700 rounded-lg text-sm">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
              </svg>
              {{ file.name }}
            </span>
          }
        </div>
      }
    </div>

    <!-- Botones de acción -->
    <div class="flex justify-end gap-4 pt-6 border-t border-gray-200">
      <button 
        type="button" 
        (click)="cancel()"
        class="px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors font-medium">
        Cancelar
      </button>
      <button 
        type="submit" 
        [disabled]="roomForm.invalid || isLoading()"
        class="px-8 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-all font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2">
        @if (isLoading()) {
          <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
          </svg>
          Guardando...
        } @else {
          {{ isEditMode() ? 'Actualizar Habitación' : 'Crear Habitación' }}
        }
      </button>
    </div>

  </form>
</div>